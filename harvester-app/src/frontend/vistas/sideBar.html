<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sidebar Toggle</title>
  <link href="../utils/sideBar.css" rel="stylesheet" />
</head>
<body>

  <div id="sidebar-wrapper">
    <!-- SIDEBAR DESPLEGADA -->
    <div class="state-default" id="sidebar-expanded">
      <div>
        <button class="boton-sidebar sidebar-logo" id="collapse-button">
          <img src="../utils/imagenes/HarvesterAppIcon.ico" />
          <span>HARVESTER</span>
          <img class="flecha-atras" src="../utils/iconos/FlechaAtras.svg" alt="Colapsar" />
        </button>
        
  
        <div class="sidebar-navegacion"  >
          <button class="boton-sidebar" data-seccion="inicio">
            <img src="../utils/iconos/Casa.svg" />
            <span>Inicio</span>
          </button>
          <button class="boton-sidebar"  data-seccion="analisis">
            <img src="../utils/iconos/GraficaBarras.svg" />
            <span>Análisis</span>
          </button>
          <button class="boton-sidebar"  data-seccion="plantillas">
            <img src="../utils/iconos/Portapapeles.svg" />
            <span>Plantillas</span>
          </button>
          <button class="boton-sidebar"  data-seccion="formulas">
            <img src="../utils/iconos/Funcion.svg" />
            <span>Fórmulas</span>
          </button>
          <button class="boton-sidebar"  data-seccion="envios">
            <img src="../utils/iconos/Correo.svg" />
            <span>Envíos</span>
          </button>
        </div>
      </div>
  
      <div class="sidebar-inferior">
        <button class="boton-sidebar"  data-seccion="usuario">
          <img src="../utils/iconos/Usuario.svg" />
          <span>Nombre Usuario</span>
        </button>
        <button class="boton-sidebar"  data-seccion="tema">
          <img src="../utils/iconos/Tema.svg" />
          <span>Modo Oscuro</span>
        </button>
      </div>
    </div>
  
    <!-- SIDEBAR COLAPSADA -->
    <div class="state-collapsed" id="sidebar-collapsed" style="display: none;">
      <div>
        <button class="boton-sidebar sidebar-logo" id="expand-button">
          <img src="../utils/iconos/Menu.svg" />
          <span>HARVESTER</span>
        </button>
  
        <div class="sidebar-navegacion">
          <button class="boton-sidebar"  data-seccion="inicio">
            <img src="../utils/iconos/Casa.svg" />
          </button>
          <button class="boton-sidebar"  data-seccion="analisis">
            <img src="../utils/iconos/GraficaBarras.svg" />
          </button>
          <button class="boton-sidebar"  data-seccion="plantillas">
            <img src="../utils/iconos/Portapapeles.svg" />
          </button>
          <button class="boton-sidebar"  data-seccion="formulas">
            <img src="../utils/iconos/Funcion.svg" />
          </button>
          <button class="boton-sidebar"  data-seccion="envios">
            <img src="../utils/iconos/Correo.svg" />
          </button>
        </div>
      </div>
  
      <div class="sidebar-inferior">
        <button class="boton-sidebar"  data-seccion="usuario">
          <img src="../utils/iconos/Usuario.svg" />
        </button>
        <button class="boton-sidebar"  data-seccion="tema">
          <img src="../utils/iconos/Tema.svg" />
        </button>
      </div>
    </div>
  </div>
  
  <script>
  const btnCollapse = document.getElementById('collapse-button');
  const btnExpand = document.getElementById('expand-button');
  const sidebarExpanded = document.getElementById('sidebar-expanded');
  const sidebarCollapsed = document.getElementById('sidebar-collapsed');

  // Alternar entre colapsado y expandido
  btnCollapse.addEventListener('click', () => {
    sidebarExpanded.style.display = 'none';
    sidebarCollapsed.style.display = 'flex';
    aplicarActivoDesdeStorage();
  });

  btnExpand.addEventListener('click', () => {
    sidebarCollapsed.style.display = 'none';
    sidebarExpanded.style.display = 'flex';
    aplicarActivoDesdeStorage();
  });

  // Función para marcar el botón activo
  function activarBotonesSidebar() {
    const botones = document.querySelectorAll('.boton-sidebar');

    botones.forEach(boton => {
      boton.addEventListener('click', () => {
        const seccion = boton.getAttribute('data-seccion');
        const yaActivo = boton.classList.contains('activo');

        // Limpiar todos los botones
        botones.forEach(b => b.classList.remove('activo'));

        // Si no estaba activo, activarlo en todas las versiones
        if (!yaActivo && seccion) {
          const coincidentes = document.querySelectorAll(`.boton-sidebar[data-seccion="${seccion}"]`);
          coincidentes.forEach(b => b.classList.add('activo'));

          // Guardar sección activa en localStorage
          localStorage.setItem('seccion-activa', seccion);
        } else {
          // Si ya estaba activo, quitar selección
          localStorage.removeItem('seccion-activa');
        }
      });
    });
  }

  // Función para aplicar clase activa desde localStorage
  function aplicarActivoDesdeStorage() {
    const seccion = localStorage.getItem('seccion-activa');
    if (!seccion) return;

    const botonesCoincidentes = document.querySelectorAll(`.boton-sidebar[data-seccion="${seccion}"]`);
    botonesCoincidentes.forEach(b => b.classList.add('activo'));
  }

  // Ejecutar al cargar
  activarBotonesSidebar();
  aplicarActivoDesdeStorage(); // aplica el estado guardado al cargar

</script>
 

</body>
</html>
